{"version":3,"file":"mock-proxy.js","names":["proxyTarget","Object","assign","__mocks","resetAll","toJSON","getMockController","prop","toReturn","o","op","hasOwnProperty","reset","proxyTraps","get","target","Reflect","apply","_target","_thisArg","mockModel","mockify","Proxy","model","modelName","Error","module","exports"],"sources":["../src/mock-proxy.js"],"sourcesContent":["// extend a plain function, we will override it with the Proxy later\nconst proxyTarget = Object.assign(() => void 0, {\n  __mocks: {},\n  resetAll() {\n    this.__mocks = {};\n  },\n  toJSON() {\n    return this.__mocks;\n  },\n});\n\nconst getMockController = (prop) => {\n  return {\n    toReturn(o, op = 'find') {\n      proxyTarget.__mocks.hasOwnProperty(prop)\n        ? (proxyTarget.__mocks[prop][op] = o)\n        : (proxyTarget.__mocks[prop] = { [op]: o });\n\n      return this;\n    },\n\n    reset(op) {\n      if (op) {\n        delete proxyTarget.__mocks[prop][op];\n      } else {\n        delete proxyTarget.__mocks[prop];\n      }\n\n      return this;\n    },\n\n    toJSON() {\n      return proxyTarget.__mocks[prop] || {};\n    },\n  };\n};\n\nconst proxyTraps = {\n  get(target, prop) {\n    if (target.hasOwnProperty(prop)) {\n      return Reflect.get(target, prop);\n    }\n\n    return getMockController(prop);\n  },\n  apply: (_target, _thisArg, [prop]) => mockModel(prop),\n};\n\nconst mockify = new Proxy(proxyTarget, proxyTraps);\n\n/**\n * Returns a helper with which you can set up mocks for a particular Model\n */\nconst mockModel = (model) => {\n  const modelName = typeof model === 'function' ? model.modelName : model;\n  if (typeof modelName === 'string') {\n    return getMockController(modelName);\n  } else {\n    throw new Error('model must be a string or mongoose.Model');\n  }\n};\n\nmodule.exports = mockify;\n"],"mappings":";;AAAA;AACA,MAAMA,WAAW,GAAGC,MAAM,CAACC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;EAC9CC,OAAO,EAAE,CAAC,CAAC;EACXC,QAAQA,CAAA,EAAG;IACT,IAAI,CAACD,OAAO,GAAG,CAAC,CAAC;EACnB,CAAC;EACDE,MAAMA,CAAA,EAAG;IACP,OAAO,IAAI,CAACF,OAAO;EACrB;AACF,CAAC,CAAC;AAEF,MAAMG,iBAAiB,GAAIC,IAAI,IAAK;EAClC,OAAO;IACLC,QAAQA,CAACC,CAAC,EAAEC,EAAE,GAAG,MAAM,EAAE;MACvBV,WAAW,CAACG,OAAO,CAACQ,cAAc,CAACJ,IAAI,CAAC,GACnCP,WAAW,CAACG,OAAO,CAACI,IAAI,CAAC,CAACG,EAAE,CAAC,GAAGD,CAAC,GACjCT,WAAW,CAACG,OAAO,CAACI,IAAI,CAAC,GAAG;QAAE,CAACG,EAAE,GAAGD;MAAE,CAAE;MAE7C,OAAO,IAAI;IACb,CAAC;IAEDG,KAAKA,CAACF,EAAE,EAAE;MACR,IAAIA,EAAE,EAAE;QACN,OAAOV,WAAW,CAACG,OAAO,CAACI,IAAI,CAAC,CAACG,EAAE,CAAC;MACtC,CAAC,MAAM;QACL,OAAOV,WAAW,CAACG,OAAO,CAACI,IAAI,CAAC;MAClC;MAEA,OAAO,IAAI;IACb,CAAC;IAEDF,MAAMA,CAAA,EAAG;MACP,OAAOL,WAAW,CAACG,OAAO,CAACI,IAAI,CAAC,IAAI,CAAC,CAAC;IACxC;EACF,CAAC;AACH,CAAC;AAED,MAAMM,UAAU,GAAG;EACjBC,GAAGA,CAACC,MAAM,EAAER,IAAI,EAAE;IAChB,IAAIQ,MAAM,CAACJ,cAAc,CAACJ,IAAI,CAAC,EAAE;MAC/B,OAAOS,OAAO,CAACF,GAAG,CAACC,MAAM,EAAER,IAAI,CAAC;IAClC;IAEA,OAAOD,iBAAiB,CAACC,IAAI,CAAC;EAChC,CAAC;EACDU,KAAK,EAAEA,CAACC,OAAO,EAAEC,QAAQ,EAAE,CAACZ,IAAI,CAAC,KAAKa,SAAS,CAACb,IAAI;AACtD,CAAC;AAED,MAAMc,OAAO,GAAG,IAAIC,KAAK,CAACtB,WAAW,EAAEa,UAAU,CAAC;;AAElD;AACA;AACA;AACA,MAAMO,SAAS,GAAIG,KAAK,IAAK;EAC3B,MAAMC,SAAS,GAAG,OAAOD,KAAK,KAAK,UAAU,GAAGA,KAAK,CAACC,SAAS,GAAGD,KAAK;EACvE,IAAI,OAAOC,SAAS,KAAK,QAAQ,EAAE;IACjC,OAAOlB,iBAAiB,CAACkB,SAAS,CAAC;EACrC,CAAC,MAAM;IACL,MAAM,IAAIC,KAAK,CAAC,0CAA0C,CAAC;EAC7D;AACF,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAGN,OAAO"}