{"version":3,"file":"model-instances.js","names":["handleMock","require","module","exports","methodName","options","cb","op","modelName","constructor","Object","assign","model","hooks","Promise","resolve","reject","execPre","err","ret","call","execPost","err2","then","ret2","err3","catch"],"sources":["../../src/mocks/model-instances.js"],"sourcesContent":["const handleMock = require('./handle-mock');\n\nmodule.exports = function (methodName) {\n  return function (options, cb) {\n    const op = methodName;\n    const { modelName } = this.constructor;\n\n    if (typeof options === 'function') {\n      cb = options;\n    }\n\n    Object.assign(this, { op, model: { modelName } });\n\n    const hooks = this.constructor.hooks;\n\n    return new Promise((resolve, reject) => {\n      hooks.execPre(op, this, [cb], (err) => {\n        if (err) {\n          reject(err);\n          return;\n        }\n\n        const ret = handleMock.call(this, cb);\n\n        if (cb) {\n          hooks.execPost(op, this, [ret], (err2) => {\n            if (err2) {\n              reject(err2);\n              return;\n            }\n\n            resolve(ret);\n          });\n        } else {\n          ret\n            .then((ret2) => {\n              hooks.execPost(op, this, [ret2], (err3) => {\n                if (err3) {\n                  reject(err3);\n                  return;\n                }\n\n                resolve(ret2);\n              });\n            })\n            .catch(reject);\n        }\n      });\n    });\n  };\n};\n"],"mappings":";;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE3CC,MAAM,CAACC,OAAO,GAAG,UAAUC,UAAU,EAAE;EACrC,OAAO,UAAUC,OAAO,EAAEC,EAAE,EAAE;IAC5B,MAAMC,EAAE,GAAGH,UAAU;IACrB,MAAQI,SAAS,GAAK,IAAI,CAACC,WAAW,CAA9BD,SAAS;IAEjB,IAAI,OAAOH,OAAO,KAAK,UAAU,EAAE;MACjCC,EAAE,GAAGD,OAAO;IACd;IAEAK,MAAM,CAACC,MAAM,CAAC,IAAI,EAAE;MAAEJ,EAAE;MAAEK,KAAK,EAAE;QAAEJ;MAAU;IAAE,CAAC,CAAC;IAEjD,MAAMK,KAAK,GAAG,IAAI,CAACJ,WAAW,CAACI,KAAK;IAEpC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;MACtCH,KAAK,CAACI,OAAO,CAACV,EAAE,EAAE,IAAI,EAAE,CAACD,EAAE,CAAC,EAAGY,GAAG,IAAK;QACrC,IAAIA,GAAG,EAAE;UACPF,MAAM,CAACE,GAAG,CAAC;UACX;QACF;QAEA,MAAMC,GAAG,GAAGnB,UAAU,CAACoB,IAAI,CAAC,IAAI,EAAEd,EAAE,CAAC;QAErC,IAAIA,EAAE,EAAE;UACNO,KAAK,CAACQ,QAAQ,CAACd,EAAE,EAAE,IAAI,EAAE,CAACY,GAAG,CAAC,EAAGG,IAAI,IAAK;YACxC,IAAIA,IAAI,EAAE;cACRN,MAAM,CAACM,IAAI,CAAC;cACZ;YACF;YAEAP,OAAO,CAACI,GAAG,CAAC;UACd,CAAC,CAAC;QACJ,CAAC,MAAM;UACLA,GAAG,CACAI,IAAI,CAAEC,IAAI,IAAK;YACdX,KAAK,CAACQ,QAAQ,CAACd,EAAE,EAAE,IAAI,EAAE,CAACiB,IAAI,CAAC,EAAGC,IAAI,IAAK;cACzC,IAAIA,IAAI,EAAE;gBACRT,MAAM,CAACS,IAAI,CAAC;gBACZ;cACF;cAEAV,OAAO,CAACS,IAAI,CAAC;YACf,CAAC,CAAC;UACJ,CAAC,CAAC,CACDE,KAAK,CAACV,MAAM,CAAC;QAClB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC;AACH,CAAC"}